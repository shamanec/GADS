<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Device Selection</title>
</head>
<style>
    .device-results li:hover {
        background-color: #b9b9b9;
    }
</style>

<body>
    <div class="topnav">
        <link href="/static/css/top_navigation_style.css" rel="stylesheet">
        <a href="/">Home</a>
        <a class="active" href="device-containers">Device selection</a>
        <a href="logs">Project logs</a>
        <a href="device-control">Device Control</a>
        <a href="swagger/index.html" target="_blank">Swagger</a>
    </div>
    <div id="top-container">
        <div id="device-selection-div">
            <ul class="device-results" id="device-results" style="display: flex;flex-direction: row;flex-wrap: wrap;">
                {{template "device_selection_table" .}}
            </ul>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        
        window.addEventListener("DOMContentLoaded", function () {
            refreshDevices()
        });

        // Refresh the devices on the page each 10 seconds
        function refreshDevices() {
            // Call the refresh-available-devices endpoint
            // And get updated html devices list
            $.ajax({
                contentType: 'text/html',
                type: "GET",
                async: false,
                url: "/refresh-available-devices",
                success: function (data) {
                    // Update the devices list with the new table data
                    document.getElementById('device-results').innerHTML = data
                },
                error: function (data) {
                    document.getElementById('device-results').innerHTML = ""
                }
            });

            addListeners()

            // Schedule the next refresh
            setTimeout(refreshDevices, 10000);
        }
    </script>
</body>

</html>