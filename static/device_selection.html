<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Device Selection</title>
</head>
<style>
    .device-results li:hover {
        background-color: #b9b9b9;
    }

    .use-device {
        background-color: #32dbb8;
        border: none;
        border-radius: 4px;
        padding: 8px 12px;
        font-size: 16px;
        cursor: pointer;
        margin: 5px;
    }
</style>

<body>
    <div class="topnav">
        <link href="/static/css/top_navigation_style.css" rel="stylesheet">
        <a href="/">Home</a>
        <a href="logs">Logs</a>
        <a class="active" href="devices">Device Control</a>
    </div>
    <div id="top-container">
        <div id="device-selection-div">
            <ul class="device-results" id="device-results" style="display: flex;flex-direction: row;flex-wrap: wrap;">
                <!-- {{template "device_selection_table"}} -->
            </ul>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // Get the hostname and port from the browser
        const hostname = window.location.hostname;
        const port = window.location.port;
        // Generate the final domain
        let domain = ""
        if (hostname.includes('ngrok')) {
            domain = hostname + (port ? ':' + port : '');
        } else {
            domain = hostname + (port ? ':' + port : '');
        }
        // Connect to a websocket on the generated domain
        let devicesSocket = new WebSocket("ws://" + domain + "/available-devices");

        // On each message over the websocket update the device selection table
        devicesSocket.onmessage = function (event) {
            document.getElementById('device-results').innerHTML = event.data
        };
    </script>
</body>

</html>